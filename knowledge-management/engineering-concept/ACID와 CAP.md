

# ACID란 #anki 
트랜잭션을 정의하는 속성
트랜잭션이 이러한 속성을 만족해야 안전하게 수행되었다고 볼 수 있다.
-   A (atomicity 원자성) : commit or rollback
-   C (consistency 일관성, 정합성) : 무결성
	-   무결성이란? 틀린 데이터도 아니고, 모순되는 데이터가 공존하지 않는 상태. -> [[정합성과 무결성]]
-   I (isolation 고립, 격리) : 동시에 실행되는 트랜잭션 사이에 어느 정도 영향을 미치는 지에 대한 정의. 트랜잭션은 다양한 isolation level을 가질 수 있고, 이에 따라 트랜잭션의 실행 결과가 달라질 수 있음. (트랜잭션 간의 끼어들기에 대한 내용)
-   D (duration 지속) : 트랜잭션을 성공적으로 끝내면 항상 그 결과가 기록되어야 함.


# CAP이란 #anki 
분산시스템의 CAP에 해당하는 3가지 모두 만족시킬 수 없다는 내용
- C (consistency, 일관성) : 모든 노드의 서버들은 같은 데이터를 보여줘야 한다.
	- 다시 노드가 살아날 때까지 모든 노드를 lock시키고 기다림.
	- 정합성을 희생하지 않는다.
	- A(Availability)를 희생하는 정책.
- A (Availability, 가용성) : 언제나 모든 사용자들은 읽기 쓰기가 가능해야 하고, 다른 노드 및 서버 장애에 영향을 받아선 안된다.
	- 여기서 말하는 장애는 노드의 장애.
	- 몇 노드가 죽어도 나머지가 트래픽 받아서 처리함.
	- global한 데이터 consistency 희생
	- C (consistency)를 희생하는 정책.
- P (Partition tolerance or Tolerance to network partition, 분리 내구성) : 노드 간에 통신에 문제가 생겨 메세지를 주고받지 못하는 상황이 되더라도 동작해야한다.
	- 여기서 말하는 장애는 노드와 노드 사이의 네트워크 장애로 인해 서로 간의 연결이 끊어진 상황. 노드의 상태는 정상.

![[Pasted image 20221003181058.png]]

# Example을 통한 이해

## MySQL - RDB
RDB는 CA만 지원하고 P를 지원하지 않는다.
이게 햇갈릴 수 있는데, `클러스터링 방식에 따라 달라질 수 있다` 고 이해해야 한다.

- Galera Cluster for MySQL (CA 지원)
- NDB Cluster for MySQL (AP 지원)

## 카산드라 (AP 지원)
- C가 없기에 사용자들은 같은 시점에 다른 응답을 받을 수 있다.
- A가 있기에 사용자들은 하나의 노드에 장애가 생겨도 바로바로 응답을 받을 수 있다.
	- 노드 간에 데이터 일관성이 없기에 문제 없다.
- P가 있기에 특정 노드간에 통신에 문제가 생겨도 사용자들은 응답을 바로바로 받을 수 있다.
	- 마찬가지로 노드간에 일관성을 포기했기 때문에 네트워크 단절이 있는 노드의 동기화를 신경쓰지 않고 서비스를 운영한다.
	- 추후 해당 노드가 복구했을 때 사용자가 응답을 요청하면 생뚱맞은 응답이 올 수 있다.

## MongoDB (CP 지원)
- C를 지원하기에 모든 사용자들은 MongoDB로부터 같은 응답을 받는다.
- A가 없기에 한 노드에 문제가 생기면 사용자들은 응답을 받을 수 없을 수도 있다.
- P가 있기에 특정 노드간에 통신에 문제가 생기면 해당 노드를 무시하고 서비스를 진행할 수 있다.
	- 다만, 네트워크 통신이 복구되었을 때 C를 지원해야하기에 해당 노드는 동기화될 때까지 사용 대기한다.



ref : https://hamait.tistory.com/197